分库分表拆分维度
1、建立映射表
2、业务双写（同步、异步binlog）

join问题
1、join逻辑上单表处理
2、宽表
3、es
------------------

B+树
1、叶子节点记录主键，按照从小到大的顺序排列，形成双向链表
2、非叶子节点取叶子节点里面key最小的值

B+树+链表
1、范围查找
2、前缀匹配、模糊匹配
3、排序、分页

每一个非主键索引对应一颗b+树，叶子节点存储的是主键的值
非主键索引会查询两颗b+树
    1、先在非主键索引的b+树上定位主键
    2、在主键索引的b+树上定位数据
-------------------

事物问题
1、脏读，读取到 uncommit
2、不可重复读，update
3、幻读，insert/delete
3、丢失更新

隔离级别
RU
RC，1
RR，1、2、3
Ser，1，2，3，4

丢失更新问题解决
1、单条语句原子性（业务场景更多的是读取结果，业务逻辑，写会数据）
2、悲观锁，for update，commit前线程挂了，死锁
3、乐观锁，比较版本号，cas，只能单表
4、分布式锁（业务逻辑操作多个表）
--------------------

A：原子性
C：一致性
I：隔离型
D：持久性
    write-ahead-log：现在内存中提交事物，然后写日志，后台任务将内存中的数据异步刷新到磁盘
----------------------

InnoDB锁
共享锁、排他锁
意向锁
记录锁
间隙锁
临时锁
插入意向锁
自增锁

binlog是mysql层面的，redo、undo log是InnoDB引擎里的工具

主从复制方式
1、同步复制
2、异步复制
2、半同步复制

主从复制原理
1、master dump thread 将binlog发送给slave
2、slave io thread接收binlog（relay log）
3、slave sql thread将relay log回防到数据库
------------------------

高并发读
1、缓存
    1 本地或集中式缓存：缓存雪崩、缓存穿透、热key过期
    2 mysql master/slave
    3 CND静态文件加速
2、并发读
    1 异步
    2 冗余请求
3、重写轻读
    1 推
    2 拉
    3 推/拉混合

读写分离（CQRS结构）
1、分别为读写设计不同的数据结构
2、分库分表抵抗写压力
3、读、写串联，通过中间件转换
4、读比写有延迟


